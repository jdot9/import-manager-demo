import { promptUser } from './promptUtils.js';
import { lib } from '../../lang/en.js';
function getSampleTypesPrompt(choices) {
    return {
        type: 'rawlist',
        name: 'sampleType',
        message: lib.prompts.createApiSamplePrompt.selectApiSampleApp,
        choices: choices.map(choice => ({
            name: `${choice.name} - ${choice.description}`,
            value: choice.id,
        })),
        validate: function (input) {
            return new Promise(function (resolve, reject) {
                if (input && input.length > 0) {
                    resolve(true);
                }
                else {
                    reject(lib.prompts.createApiSamplePrompt.errors.apiSampleAppRequired);
                }
            });
        },
    };
}
function getLanguagesPrompt(choices) {
    return {
        type: 'rawlist',
        name: 'sampleLanguage',
        message: lib.prompts.createApiSamplePrompt.selectLanguage,
        choices: choices.map(choice => ({
            name: choice,
            value: choice,
        })),
        validate: function (input) {
            return new Promise(function (resolve, reject) {
                if (input && input.length > 0) {
                    resolve(true);
                }
                reject(lib.prompts.createApiSamplePrompt.errors.languageRequired);
            });
        },
    };
}
export async function createApiSamplePrompt(samplesConfig) {
    try {
        const { samples } = samplesConfig;
        const sampleTypeAnswer = await promptUser(getSampleTypesPrompt(samples));
        const chosenSample = samples.find(sample => sample.id === sampleTypeAnswer.sampleType);
        const { languages } = chosenSample;
        const languagesAnswer = await promptUser(getLanguagesPrompt(languages));
        return {
            ...sampleTypeAnswer,
            ...languagesAnswer,
        };
    }
    catch (e) {
        return {};
    }
}
