import { getConfigDefaultAccountIfExists, getAllConfigAccounts, } from '@hubspot/local-dev-lib/config';
import { promptUser } from './promptUtils.js';
import { commands } from '../../lang/en.js';
import { uiAccountDescription } from '../ui/index.js';
function mapAccountChoices(portals) {
    return (portals?.map(p => ({
        name: uiAccountDescription(p.accountId, false),
        value: p.accountId,
    })) || []);
}
export async function selectAccountFromConfig(prompt = '') {
    const accountsList = getAllConfigAccounts();
    const defaultAccount = getConfigDefaultAccountIfExists();
    const { default: selectedDefault } = await promptUser([
        {
            type: 'list',
            name: 'default',
            pageSize: 20,
            message: prompt || commands.account.subcommands.use.promptMessage,
            choices: mapAccountChoices(accountsList),
            default: defaultAccount?.accountId ?? undefined,
        },
    ]);
    return selectedDefault;
}
